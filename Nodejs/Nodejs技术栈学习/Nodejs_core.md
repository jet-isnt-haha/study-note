# Module -模块

[什么是Node.js模块（Module）？如何导入和导出模块？_nodejs模块化导入导出-CSDN博客](https://blog.csdn.net/yuanlong12178/article/details/145795758)





# HTTP/HTTPS/HTTP2

[半小时搞懂 HTTP、HTTPS和HTTP2 - 知乎](https://zhuanlan.zhihu.com/p/141458270)

### HTTP概述

HTTP超文本传输协议是位于TCP/IP体系结构中的应用层协议，它是万维网数据通信的基础。



当我们访问一个网站时，需要通过统一资源定位符（uniform resource locator，URL）来定位服务器并获取资源

`<协议>://<域名>:<端口>/<路径>`

一个URL的一般形式通常如上所示，现在最常用的协议就是HTTP,HTTP的默认端口是80，通常可以省略。



### HTTP/1.1

HTTP/1.1是目前使用最广泛的版本，一般没有特别标明版本都是指HTTP/1.1。



### HTTP连接建立过程

我们来看一下在浏览器输入URL后获取HTML页面的过程。



1. 先通过域名系统(Domain Name System，DNS)查询将域名转换为IP地址。即将 `test.com`转换为 `221.239.100.30`这一过程。
2. 通过三次握手建立TCP连接。
3. 发起HTTP请求
4. 目标服务器接收到HTTP请求并处理。
5. 目标服务器往浏览器发回HTTP响应。
6. 浏览器解析并渲染页面

下图中的RTT为往返时延（Round-Trip Time：往返时延。表示从发送端发送数据开始，到发送端收到来自接收端的确认，总共经历的时延）。

![img](https://pic1.zhimg.com/v2-ddcb4a085bbde7f8bf80f792d4ac7e48_1440w.jpg)



### HTTP连接拆除过程

所有HTTP客户端（浏览器）、服务器都可以在任意时刻关闭TCP连接。通常会在一条报文结束时关闭连接，但出错的时候，也可能在首部行的中间或其他任意位置关闭连接。



### TCP三次握手和四次挥手

由于HTTP是基于TCP的，所以打算在这补充一下TCP连接建立和拆除的过程。



首先，我们需要了解一些TCP报文段的字段和标志位：

1. 32比特的序号字段和确认号字段，TCP字节流每一个字节都按顺序编号。确认号是接收方期望从对方收到的下一字节的序号。
2. ACK标志位，用于指示确认字段中的值是有效的ACK=1有效，ACK=0无效。
3. SYN标志位，用于连接建立，SYN为1时，表明这是一个请求建立连接报文。
4. FIN标志位，用于连接拆除，FIN为1时，表明发送方数据已发送完毕，并要求释放连接。

![img](https://pic4.zhimg.com/v2-578eeb6309c44c4607344fe019dff19b_1440w.jpg)

### TCP三次握手建立连接

TCP标准规定，ACK报文段可以携带数据，但不携带数据就不用消耗序号。

1. 客户端发送一个不包含应用层数据的报文段，首部的SYN置为1，随机选择一个初始序号（一般为0）放在TCP报文段的序号字段中。（SYN为1的时候，不能携带数据，但要消耗掉一个序号）
2. TCP报文段到达服务器主机后，服务器提取报文段，并为该TCP连接分配缓存和变量。然后向客户端发送允许连接的ACK报文段（不包含应用层数据）。这个报文段的首部包含4个信息：ACK置为1，SYN置为1；确认号字段置为客户端的序号+1；随机选择自己的初始序号（一般为0）
3. 收到服务器的TCP响应报文段后，客户端也要为该TCP连接分配缓存和变量，并向服务器发送一个ACK报文段。这个报文段将服务器端的序号+1放置在确认号字段中，用来对服务器允许连接的报文段进行响应，因为连接已经建立，所有SYN置为0.最后一个阶段，报文段可以携带客户端到服务器的数据。并且以后的每一个报文段，SYN都置为0



具体实例：

![img](https://picx.zhimg.com/v2-eb4981e4f58f1822c00d7d290d14ee51_1440w.jpg)



### TCP四次挥手拆除连接

FIN报文段即使不携带数据，也要消耗序号。



1. 客户端发送一个FIN置为1的报文段。
2. 服务器回送一个确认报文段。
3. 服务器发送FIN置为1的报文段。
4. 客户端回送一个确认报文段。



### TCP 为什么是四次挥手，而不是三次？

1. 当 A 给 B 发送 FIN 报文时，代表 A 不再发送报文，但仍可以接收报文。
2. B 可能还有数据需要发送，因此先发送 ACK 报文，告知 A “我知道你想断开连接的请求了”。这样 A 便不会因为没有收到应答而继续发送断开连接的请求（即 FIN 报文）。
3. B 在处理完数据后，就向 A 发送一个 FIN 报文，然后进入 LAST_ACK 阶段（超时等待）。
4. A 向 B 发送 ACK 报文，双方都断开连接。





